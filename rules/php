{"include": {"regText": "(include|require)(_once){0,1}(\\s{1,5}|\\s{0,5}\\().{0,60}\\$(?!.*(this->))\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "文件包含函數中存在變量,可能存在文件包含漏洞"}, "preg_replace": {"regText": "preg_replace\\(\\s{0,5}.*/[is]{0,2}e[is]{0,2}[\"']\\s{0,5},(.*\\$.*,|.*,.*\\$)", "content": "preg_replace的/e模式，且有可控變量，可能存在代碼執行漏洞"}, "phpinfo": {"regText": "phpinfo\\s{0,5}\\(\\s{0,5}\\)", "content": "phpinfo()函數，可能存在敏感信息洩露漏洞"}, "call_user_func": {"regText": "call_user_func(_array){0,1}\\(\\s{0,5}\\$\\w{1,15}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "call_user_func函數參數包含變量，可能存在代碼執行漏洞"}, "readfile": {"regText": "(file_get_contents|fopen|readfile|fgets|fread|parse_ini_file|highlight_file|fgetss|show_source)\\s{0,5}\\(.{0,40}\\$\\w{1,15}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "讀取文件函數中存在變量，可能存在任意文件讀取漏洞"}, "systemexec": {"regText": "(system|passthru|pcntl_exec|shell_exec|escapeshellcmd|exec|popen|proc_open)\\s{0,10}\\(.{0,40}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "命令執行函數中存在變量，可能存在任意命令執行漏洞"}, "parse_str": {"regText": "(mb_){0,1}parse_str\\s{0,10}\\(.{0,40}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "parse_str函數中存在變量,可能存在變量覆蓋漏洞"}, "doublemoney": {"regText": "\\${{0,1}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}\\s{0,4}=\\s{0,4}.{0,20}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "\u53cc$$\u7b26\u53f7\u53ef\u80fd\u5b58\u5728\u53d8\u91cf\u8986\u76d6\u6f0f\u6d1e"}, "ipinfo": {"regText": "[\"'](HTTP_CLIENT_IP|HTTP_X_FORWARDED_FOR|HTTP_REFERER)[\"']", "content": "獲取IP地址方式可偽造，HTTP_REFERER可偽造，常見引發SQL注入等漏洞"}, "filectrol": {"regText": "(unlink|copy|fwrite|readfile|file_put_contents|file_get_contents|bzopen)\\s{0,10}\\(.{0,40}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "文件操作函數中存在變量，可能存在任意文件讀取/刪除/修改/寫入等漏洞"}, "extract": {"regText": "(extract)\\s{0,5}\\(.{0,30}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}\\s{0,5},{0,1}\\s{0,5}(EXTR_OVERWRITE){0,1}\\s{0,5}\\)", "content": "extract函數中存在變量，可能存在變量覆蓋漏洞"}, "codeexec": {"regText": "\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}\\s{0,5}\\(\\s{0,5}\\$_(POST|GET|REQUEST|SERVER)\\[.{1,20}\\]", "content": "可能存在代碼執行漏洞,或者此處是後門"}, "urldecode": {"regText": "^(?!.*addslashes).{0,40}((raw){0,1}urldecode|stripslashes)\\s{0,5}\\(.{0,60}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "urldecode繞過GPC,stripslashes會取消GPC轉義字符"}, "double``": {"regText": "`\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}`", "content": "``反引號中包含變量，變量可控會導致命令執行漏洞"}, "array_map": {"regText": "array_map\\s{0,4}\\(\\s{0,4}.{0,20}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}\\s{0,4}.{0,20},", "content": "array_map參數包含變量，變量可控可能會導致代碼執行漏洞"}, "sql_select": {"regText": "select\\s{1,4}.{1,60}from.{1,50}where\\s{1,3}.{1,50}=[\"\\s\\.]{0,10}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "SQL語句select中條件變量無單引號保護，可能存在SQL注入漏洞"}, "sql_delete": {"regText": "delete\\s{1,4}from.{1,20}where\\s{1,3}.{1,30}=[\"\\s\\.]{0,10}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "SQL語句delete中條件變量無單引號保護，可能存在SQL注入漏洞"}, "sql_insert": {"regText": "insert\\s{1,5}into\\s{1,5}.{1,60}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "SQL語句insert中插入變量無單引號保護，可能存在SQL注入漏洞"}, "sql_update": {"regText": "update\\s{1,4}.{1,30}\\s{1,3}set\\s{1,5}.{1,60}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "SQL語句delete中條件變量無單引號保護，可能存在SQL注入漏洞"}, "eval": {"regText": "(eval|assert)\\s{0,10}\\(.{0,60}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "eval或者assertc函數中存在變量，可能存在代碼執行漏洞"}, "echo": {"regText": "(echo|print|print_r)\\s{0,5}\\({0,1}.{0,60}\\$_(POST|GET|REQUEST|SERVER)", "content": "echo等輸出中存在可控變量，可能存在XSS漏洞"}, "header": {"regText": "(header\\s{0,5}\\(.{0,30}|window.location.href\\s{0,5}=\\s{0,5})\\$_(POST|GET|REQUEST|SERVER)", "content": "header函數或者js location有可控參數，存在任意跳轉或http頭污染漏洞"}, "upload": {"regText": "move_uploaded_file\\s{0,5}\\(", "content": "存在文件上傳，注意上傳類型是否可控"}, "unserialize": {"regText": "(unserialize)\\s{0,5}\\({0,1}.{0,60}\\$_(POST|GET|REQUEST|SERVER)", "content": "unserialize函數中存在變量,可能存在反序列化漏洞"}, "unserialize2": {"regText": "(unserialize)\\s{0,10}\\(.{0,60}\\$\\w{1,20}((\\[[\"']|\\[)\\${0,1}[\\w\\[\\]\"']{0,30}){0,1}", "content": "unserialize函數中存在變量,可能存在反序列化漏洞"}, "ssrf": {"regText": "\\b(fsockopen|curl_exec)\\s{0,400}\\(.{0,400}\\$\\w{1,100}", "content": "遠程請求函數中存在變量,可能存在SSRF漏洞"}, "PHAR_basic": {"regText": "\\b(getimagesize|exif_thumbnail|exif_imagetype|imageloadfont| hash_hmac_file|hash_file|hash_update_file|md5_file|sha1_file| get_meta_tags|get_headers)\\s{0,400}\\(.{0,400}\\$\\w{1,100}", "content": ",可能存在PHAR反序列列化漏洞(一般類型)"}, "PHAR_img": {"regText": "\\b(imagecreatefrom)\\w{0,10}\\s{0,400}\\(.{0,400}\\$\\w{1,100}", "content": ",可能存在PHAR反序列列化漏洞(圖片轉換）"}}
